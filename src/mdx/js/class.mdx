export let metadata = {
  title: 'ìë°”ìŠ¤í¬ë¦½íŠ¸ ê³µë¶€ ê¸°ë¡ - í´ë˜ìŠ¤',
  description:
    'í´ë˜ìŠ¤ì˜ ì„±ì§ˆì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„ë˜ëŠ”ì§€ ê³µë¶€í–ˆìŠµë‹ˆë‹¤.',
};

# Classes

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” í”„ë¡œí† íƒ€ì… ê¸°ë°˜ ìƒì†ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

> Although the prototype object is the key feature of the class, the constructor
> function is the public identity of the class.

## Classes and Prototypes

íŒ©í† ë¦¬ í•¨ìˆ˜ë¡œ ë™ì¼í•œ í”„ë¡œí† íƒ€ì…ì„ ê°€ì§€ëŠ” ê°ì²´ë“¤ì„ ë°˜í™˜í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.
í”„ë¡œí† íƒ€ì…ì„ ì—°ê²°í•˜ëŠ” ê³¼ì •ì´ ëª…ì‹œì ìœ¼ë¡œ ë“œëŸ¬ë‚˜ìš”:

```js
function createRange(from, to) {
  // í”„ë¡œí† íƒ€ì… ê°ì²´ë¥¼ ì¸ìë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
  let r = Object.create(createRange.methods);
  r.from = from;
  r.to = to;
  return r;
}

// í”„ë¡œí† íƒ€ì… ê°ì²´ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
createRange.methods = {
  includes(x) {
    return this.from <= x && x < this.to;
  },
};

let r1 = createRange(1, 4);
console.log(r1.includes(2));

let r2 = createRange(2, 3);
console.log(r2.includes(5));
```

## Classes and Constructors

`new` í‚¤ì›Œë“œë¥¼ í†µí•´ ê°ì²´ì˜ ìƒì„±ê³¼ í”„ë¡œí† íƒ€ì… ì—°ê²°ì„ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```js
function Range(from, to) {
  if (!new.target) {
    throw new Error('í•¨ìˆ˜ê°€ ìƒì„±ìë¡œì„œ í˜¸ì¶œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
  }
  this.from = from;
  this.to = to;
}

Range.prototype = {
  includes(x) {
    return this.from <= x && x < this.to;
  },
};

// âœï¸ newë¥¼ ì§€ì›Œë³´ì„¸ìš”
let r = new Range(1, 4);
console.log(r.includes(2), r.includes(5));
```

`instanceOf`ëŠ” í”„ë¡œí† íƒ€ì… ê°ì²´ê°€ ê°™ì€ì§€ë§Œ í™•ì¸í•˜ì§€ ê°ì²´ë¥¼ ë§Œë“  ìƒì„±ìë¥¼ ì •í™•íˆ
ì•Œë ¤ì£¼ëŠ”ê±´ ì•„ë‹™ë‹ˆë‹¤:

```js
function A() {}
function B() {}
// ì´ëŸ° ê²½ìš°ê°€ ì–¼ë§ˆë‚˜ ìˆê² ë‚˜ ì‹¶ì§€ë§Œ,,,
A.prototype = B.prototype = {};

let a = new A();
console.log(a instanceof A, a instanceof B);
```

ë”°ë¼ì„œ í˜¹ì‹œë‚˜ í”„ë¡œí† íƒ€ì… ê°ì²´ë¥¼ ì§ì ‘ ë§Œë“ ë‹¤ë©´ constructor ê°ì²´ë¥¼ ì˜
ì„¤ì •í•´ì¤ì‹œë‹¤:

```js
function Range(from, to) {
  this.from = from;
  this.to = to;
}

Range.prototype = {
  includes(x) {
    return this.from <= x && x < this.to;
  },
  constructor: Range,
};

let r = new Range(1, 5);
console.log(r.constructor);
```

## Classes with the class keyword

ES6ì— ì¶”ê°€ëœ `class` ë¬¸ë²•ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë´…ì‹œë‹¤:

```js
class Range {
  constructor(from, to) {
    this.from = from;
    this.to = to;
  }

  includes(x) {
    return this.from <= x && x < this.to;
  }
}
let r = new Range(1, 4);
console.log(r.includes(2), r.includes(5));
// constructorë¥¼ ìë™ìœ¼ë¡œ ì˜ ì„¤ì •í•´ì¤ë‹ˆë‹¤.
console.log(r.constructor);
```

í´ë˜ìŠ¤ì˜ ë³¸ë¬¸ì€ ìë™ìœ¼ë¡œ strict modeê°€ ì ìš©ë©ë‹ˆë‹¤:

```js
class A {
  constructor() {
    with () {}
  }
}
```

static ë©”ì„œë“œëŠ” í”„ë¡œí† íƒ€ì… ê°ì²´ê°€ ì•„ë‹Œ í•¨ìˆ˜ ìì²´ì— ì¶”ê°€ë©ë‹ˆë‹¤:

```js
class A {
  static foo() {}
}

console.log('foo' in A, 'foo' in A.prototype);
```

ìµœê·¼ì— ë” ë§ì€ ì¢…ë¥˜ì˜ í”„ë¡œí¼í‹°ë“¤ì„ í´ë˜ìŠ¤ ë³¸ë¬¸ì—ì„œ ì´ˆê¸°í™”í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤:

```js
class Buffer {
  static val = 10;

  // private instance field
  // (protected ì ‘ê·¼ì œì–´ìëŠ” JSì— ë”°ë¡œ ì—†ìŠµë‹ˆë‹¤)
  #size = 0;

  capacity = 4096;
  buffer = new Uint8Array(this.capacity);

  constructor() {
    console.log(this.buffer.length);
  }
}

console.log(Buffer.val);
new Buffer();
```

## Adding Methods to Existing Classes

í”„ë¡œí† íƒ€ì… ê°ì²´ë¥¼ ìˆ˜ì •í•´ í´ë˜ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// âœï¸ í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ ë°”ê¾¸ê³  ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”
Number.prototype.tree = function () {
  let n = this.valueOf();
  for (let i = 1; i <= n; i++) console.log('*'.repeat(i));
};

(3).tree();
```

ë‹¤ë§Œ ìœ„ ì˜ˆì œì²˜ëŸ¼ ë¹ŒíŠ¸ì¸ ê°ì²´ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ì˜, í˜¹ì€ JS
ë²„ì „ê°„ì˜ ì¶©ëŒì´ ìˆì„ ìˆ˜ ìˆì–´ ì¢‹ì§€ ì•ŠìŠµë‹ˆë‹¤.

## Subclasses

ES6 ì´ì „ ë°©ì‹:

```js
// ë¶€ëª¨ í´ë˜ìŠ¤ ìƒì„±ì
function Range(from, to) {
  this.from = from;
  this.to = to;
}

Range.prototype = {
  includes(x) {
    return this.from <= x && x < this.to;
  },
  constructor: Range,
};

// ìì‹ í´ë˜ìŠ¤ ìƒì„±ì
function Span(start, span) {
  // ë¶€ëª¨ í´ë˜ìŠ¤ì˜ êµ¬í˜„ì— í˜¸í™˜ë˜ë„ë¡ ìì‹ í´ë˜ìŠ¤ì—ì„œë„ ì´ˆê¸°í™”ë¥¼ í•´ì•¼í•©ë‹ˆë‹¤.
  // ES6 ì „ê¹Œì§€ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë‚˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ì œê³µí•˜ì§€ ì•Šê¸°ì—
  // ë¶€ëª¨ í´ë˜ìŠ¤ì˜ êµ¬í˜„ì„ ì •í™•íˆ ì•Œì•„ì•¼í•©ë‹ˆë‹¤.

  this.from = start;
  this.to = start + span;

  // ì´ëŸ° ì§“ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  // Range.call(this, start, start + span);
}

// â­ ì•„ë˜ ì¤„ì„ ì´í•´í•´ë³´ì„¸ìš”
Span.prototype = Object.create(Range.prototype);
Span.prototype.constructor = Span;

console.log(new Span(5, 5).includes(8));
```

`extends`ì™€ `super`ë¥¼ ì‚¬ìš©í•´ ì„œë¸Œí´ë˜ìŠ¤ ë§Œë“¤ê¸°:

```js
class Range {
  constructor(from, to) {
    this.from = from;
    this.to = to;
  }
  includes(x) {
    return this.from <= x && x < this.to;
  }
}

class Span extends Range {
  constructor(start, span) {
    super(start, start + span);
  }
}

console.log(new Span(5, 5).includes(8));
```

`extends`ë¥¼ ì‚¬ìš©í•˜ë©´ static ë©”ì„œë“œë„ ì•Œì•„ì„œ ìƒì†ë©ë‹ˆë‹¤. ì´ëŸ° ì‘ì—…ì€ ES6 ì´ì „ì—ëŠ”
ë¶ˆê°€ëŠ¥í–ˆì–´ìš”:

```js
class A {
  static foo() {}
}

class B extends A {}

console.log(A.foo === B.foo);
```

ê°‘ìê¸° ìƒê°ë‚œ ì˜ˆì œ:

```js
class A {
  static toString() {
    return 'class';
  }
  toString() {
    return 'instance';
  }
}

console.log(String(A));
console.log(String(new A()));
```

**static initialization blocks**ì€ í´ë˜ìŠ¤ì˜ ìœ ì—°í•œ ì´ˆê¸°í™”ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤:

```js
// @noexec
// âš ï¸
class A {
  static init() {
    //
    // Access to private static fields is allowed here
  }
}

// exposes an implementation detail to the user
A.init();

// âœ…
class B {
  static {
    // ...
  }
}
```

ì±…ì—ëŠ” ì—†ì—ˆì§€ë§Œ í´ë˜ìŠ¤ ì„ ì–¸ê³¼ ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„± ê³¼ì •ì´ ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë´¤ì–´ìš”.

https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#evaluation_order

ìš°ì„  í´ë˜ìŠ¤ ì„ ì–¸ë¬¸ì˜ í‰ê°€ ìˆœì„œì…ë‹ˆë‹¤:

```js
// 1ï¸âƒ£ extendsê°€ ìˆë‹¤ë©´ ìƒì„±ì í•¨ìˆ˜ê°€ ë§ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤
// âœï¸ ì£¼ì„ì„ í•´ì œí•˜ê³  ì–´ë–¤ ì—ëŸ¬ê°€ ëœ¨ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”
class A /* extends 1 */ {
  // 2ï¸âƒ£ constructor ë©”ì„œë“œì˜ ì¡´ì¬ë¥¼ í™•ì¸í•˜ê³  ì—†ë‹¤ë©´ ê¸°ë³¸ êµ¬í˜„ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.
  constructor() {}

  // 3ï¸âƒ£ í”„ë¡œí¼í‹° 'í‚¤'ë“¤ì„ ì„ ì–¸ ìˆœì„œëŒ€ë¡œ í‰ê°€í•©ë‹ˆë‹¤.

  // 4ï¸âƒ£ ë©”ì„œë“œì™€ ì ‘ê·¼ìë¥¼ ì„ ì–¸ ìˆœì„œëŒ€ë¡œ installí•©ë‹ˆë‹¤.

  // <ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ>ëŠ” prototypeì—,
  method1() {}

  // <private ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ>ëŠ” ë‚˜ì¤‘ì— ì¸ìŠ¤í„´ìŠ¤ì— ì§ì ‘,
  #method2() {}

  // <static ë©”ì„œë“œ>ëŠ” í´ë˜ìŠ¤ ìì²´ì— installë©ë‹ˆë‹¤.
  static method3() {}

  // 5ï¸âƒ£ ì´ì œë¶€í„° í´ë˜ìŠ¤ Aì˜ ì´ë¦„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  // ì´ì „ ë‹¨ê³„ì—ì„œ ì‚¬ìš©í•˜ë©´ ReferenceErrorê°€ ë°œìƒí•©ë‹ˆë‹¤.
  // âœï¸ ë§¨ ì•„ë˜ logged í•¨ìˆ˜ì˜ ì£¼ì„ì„ í•´ì œí•´ë³´ì„¸ìš”

  // 6ï¸âƒ£ í”„ë¡œí¼í‹° 'ê°’'ë“¤ì´ í‰ê°€ë©ë‹ˆë‹¤

  // <static í•„ë“œ>ì˜ 'ê°’'ì´ í‰ê°€ë  ë•Œ thisì˜ ê°’ì€ í´ë˜ìŠ¤ ìì²´ì…ë‹ˆë‹¤.
  static [logged('key1')] = logged('val1');
  static [logged('key2')] = (() => {
    console.log(A === this);
    // ğŸ¤” ì™œ ì–´ë–¤ê±´ undefinedê³  ì–´ë–¤ê±´ ì•„ë‹Œì§€ ê³ ë¯¼í•´ë³´ì„¸ìš”
    console.log(A.key1, A.key3, A.method3);
    return 'val2';
  })();
  static {
    console.log('Static initialization blocks', this.key2, this.key3);
  }
  static [logged('key3')] = logged('val3');

  // <ì¸ìŠ¤í„´ìŠ¤ í•„ë“œ>ì˜ 'ê°’'ë“¤ì€ ìƒì„±ì ì‹œì‘ ì „(base classì¸ ê²½ìš°) í˜¹ì€
  // superì˜ ë¦¬í„´ ì „(derived classì¸ ê²½ìš°)ì— ì´ˆê¸°í™”ë©ë‹ˆë‹¤.
  // ìì„¸í•œê±´ ë‚˜ì¤‘ ì˜ˆì œì—ì„œ ë³¼ê²Œìš”
  [logged('key4')] = logged('val4');
}

// helper function
function logged(val) {
  // console.log(A);
  console.log(`log: ${val}`);
  return val;
}

// 7ï¸âƒ£ ë!
```

ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„± ê³¼ì • ì˜ˆì œì…ë‹ˆë‹¤:

https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/constructor

```js
class A {
  x = logged(123);

  constructor() {
    // 3ï¸âƒ£
    // thisë¡œ ìƒì„±ì¤‘ì¸ ê°ì²´ì— ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤
    // í”„ë¡œí† íƒ€ì… ê°ì²´ëŠ” ì´ë¯¸ í´ë˜ìŠ¤ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ ì´ˆê¸°í™”ëê¸°ì— B ì¸ìŠ¤í„´ìŠ¤ì˜ toStringì´ ì˜ ë¶ˆë¦½ë‹ˆë‹¤.
    console.log(this.toString());

    // new.targetìœ¼ë¡œ ìƒì„±ì í•¨ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    // í´ë˜ìŠ¤ê°€ ì˜ ì„¤ê³„ë˜ì—ˆë‹¤ë©´ ë¶€ëª¨ìª½ì—ì„œ ìì‹ ìª½ ìƒì„±ìë¥¼ ê¶ê¸ˆí•´í•  ì´ìœ ê°€ ì—†ì§€ë§Œ ë””ë²„ê¹…ë“±ë“±ì— ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ë„¤ìš”.
    console.log(new.target.toString());

    // í•˜ì§€ë§Œ ìì‹ í´ë˜ìŠ¤ì˜ í”„ë¡œí¼í‹°ëŠ” ì•„ì§ ì—†ìŠµë‹ˆë‹¤
    console.log(this.y);
  }

  static toString() {
    return 'class A';
  }

  toString() {
    return 'instance of A';
  }
}

class B extends A {
  y = logged(456);

  constructor() {
    // 1ï¸âƒ£ super ì´ì „ì˜ ìƒì„±ì ë³¸ë¬¸ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.
    // ì•„ì§ì€ this ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
    console.log('Before super');

    // 2ï¸âƒ£ superê°€ í˜¸ì¶œë˜ì–´ ë¶€ëª¨ í´ë˜ìŠ¤ ë¶€ë¶„ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
    super();
    // 4ï¸âƒ£ í˜„ì¬ í´ë˜ìŠ¤ í•„ë“œë“¤ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.

    // 5ï¸âƒ£ super ì´í›„ì˜ ìƒì„±ì ë³¸ë¬¸ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.
    // ì´ì œ thisë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    console.log('After super');
    console.log(this.y);
  }

  static toString() {
    return 'class B';
  }

  toString() {
    return 'instance of B';
  }
}

new B();

// helper function
function logged(val) {
  console.log(`log: ${val}`);
  return val;
}
```

í´ë˜ìŠ¤ ì„ ì–¸ì—ì„œ í‚¤ëŠ” í•œ ë²ˆ, ì¸ìŠ¤í„´ìŠ¤ í•„ë“œ ê°’ì€ ë§¤ë²ˆ í‰ê°€ë¨ì´ ì¸ìƒê¹Šì–´ì„œ ì•„ë˜
ì˜ˆì œë¥¼ ë§Œë“¤ì–´ë´¤ì–´ìš”:

```js
class A {
  [randomVal()] = randomVal();

  toString() {
    return JSON.stringify(this);
  }
}

// í‚¤ê°€ í•­ìƒ ê°™ìŠµë‹ˆë‹¤
console.log(new A(), new A(), new A());

// helper function
function randomVal() {
  return Math.floor(Math.random() * 10);
}
```

## ì½ì–´ë³¼ë§Œí•œ ê²ƒë“¤

`apply`ë¥¼ í™œìš©í•œ ì˜›ë‚ ì˜›ì  ìƒì† êµ¬í˜„:

https://fromanegg.com/post/2013/01/03/constructor-chaining-inheritance-in-javascript/

ìƒì†ë³´ë‹¤ëŠ” ì»´í¬ì§€ì…˜(composition)ì„ ì„ í˜¸í•˜ë¼ëŠ” ë§ë„ ìˆìŠµë‹ˆë‹¤:

https://en.wikipedia.org/wiki/Composition_over_inheritance

JSê°€ abstract methodë‚˜ abstract classë¥¼ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•˜ì§€ëŠ” ì•Šì§€ë§Œ ì•„ë˜ì™€ ê°™ì´
í‰ë‚´ëŠ” ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```js
// @noexec
class AbstractSet {
  has(x) {
    throw new Error('Abstract method');
  }
}
```

ì—¬ë‹´ìœ¼ë¡œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œëŠ” abstract classë¥¼ ë”°ë¡œ ì§€ì›í•©ë‹ˆë‹¤:

https://www.typescriptlang.org/docs/handbook/classes.html#abstract-classes
