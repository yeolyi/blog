import ImageViewer from '@/client/components/common/ImageViewer';

ì´í„°ëŸ¬ë¸”í•œ ê°ì²´ëŠ” ê·¸ ìš”ì†Œë“¤ì„ ìˆœíšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ê¸°ëŠ¥ë“¤ì—ì„œ ì¡°ìš©íˆ
í™œìš©ë˜ê³  ìˆì–´ìš”.

- for/of loop
- spread operator
- destructuring assignment
- Set/Map ë“±ì˜ ìƒì„±ìì˜ ì¸ì

## How Iterators Work

- **ì´í„°ëŸ¬ë¸”** ê°ì²´ëŠ” `iterator` ë©”ì„œë“œê°€ ìˆì–´ **ì´í„°ë ˆì´í„°** ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
- ì´í„°ë ˆì´í„°ëŠ” `next` ë©”ì„œë“œë¡œ **ì´í„°ë ˆì´ì…˜ ê²°ê³¼**(iteration result) ê°ì²´ë¥¼
  ë°˜í™˜í•©ë‹ˆë‹¤.
- **ì´í„°ë ˆì´ì…˜ ê²°ê³¼** ê°ì²´ëŠ” `value`ì™€ `done` í”„ë¡œí¼í‹°ë¥¼ ê°€ì§€ëŠ” ê°œì²´ì…ë‹ˆë‹¤.

ë§ë³´ë‹¨ ì½”ë“œê°€ ì´í•´í•˜ê¸° ì‰¬ì›Œìš”:

```js
let iterable = [1, 2, 3, 4];
let iterator = iterable[Symbol.iterator]();

// ì§ì ‘ next ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê³ ,,,
let iterationResult = iterator.next();
console.log(iterationResult);

// ì–¸ì–´ ì°¨ì›ì—ì„œ ì•”ë¬µì ìœ¼ë¡œ í˜¸ì¶œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
console.log(...iterator);

// ìˆœíšŒê°€ ëë‚¬ê¸°ì— `done: true` ì—ìš”
console.log(iterator.next());
```

ìœ„ ì½”ë“œì—ì„œ spread operatorëŠ” ì´í„°ëŸ¬ë¸”ì„ í•„ìš”ë¡œí•˜ì§€ë§Œ `iterator` ë³€ìˆ˜ê°€
ì´í„°ë ˆì´í„°ë©´ì„œ ì´í„°ëŸ¬ë¸”ì´ê¸°ì— spread operatorì—ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë ‡ë“¯
ì´í„°ë ˆì´í„°ì¸ ë™ì‹œì— ì´í„°ëŸ¬ë¸”ì¸ ê°ì²´ëŠ” ì‚¬ìš©ì´ í¸ë¦¬í•œë°, ì´ë¥¼
**IterableIterator**ë¼ê³ ë„ í•©ë‹ˆë‹¤.

## Implementing Iterable Objects

```js
class Range {
  constructor(from, to) {
    this.from = from;
    this.to = to;
  }

  [Symbol.iterator]() {
    let next = this.from;
    let last = this.to;

    return {
      next: () => (next <= last ? { value: next++ } : { done: true }),

      // ì´í„°ëŸ¬ë¸”ì´í„°ë ˆì´í„°ë¥¼ ë§Œë“­ë‹ˆë‹¤.
      // âœï¸ ì•„ë˜ ë©”ì„œë“œë¥¼ ì§€ì›Œë³´ì„¸ìš”.
      [Symbol.iterator]() {
        return this;
      },
    };
  }
}

for (let x of new Range(1, 5)) console.log(x);

let iterable = new Range(6, 10);
let iterator = iterable[Symbol.iterator]();
console.log(iterator.next());
console.log(...iterator);
```

ì´í„°ë ˆì´ì…˜ì„ ë§ˆì¹˜ë©´ íŒŒì¼ì„ ë‹«ê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ëŠëŠ” ë“± ì •ë¦¬ê°€ í•„ìš”í•œ ê²½ìš°ê°€
ìˆìŠµë‹ˆë‹¤. `done`ì—ë§Œ ì˜ì¡´í•˜ë©´ ëê¹Œì§€ ìˆœíšŒí•˜ì§€ ì•Šê³  ìˆœíšŒê°€ ì¢…ë£Œë˜ëŠ” ê²½ìš°ë¥¼
ì²˜ë¦¬í•˜ì§€ ëª»í•˜ë‹ˆ `return()` ë©”ì„œë“œë¥¼ í™œìš©í•©ë‹ˆë‹¤. ìŠ¤í”„ë ˆë“œ ì—°ì‚°ìì™€ ê°™ì€ ë¹ŒíŠ¸ì¸
ê¸°ëŠ¥ë“¤ì€ ìˆœíšŒê°€ ëŠê¸°ë©´ `return()`ì„ í˜¸ì¶œí•´ì¤˜ìš”:

```js
class MyIterable {
  [Symbol.iterator]() {
    let val = 1;

    return {
      next() {
        if (5 < val) {
          console.log('done');
          return { done: true };
        } else {
          return { value: val++ };
        }
      },

      return() {
        console.log('return');
        return { done: true };
      },
    };
  }
}

// ìˆœíšŒê°€ ì •ìƒì ìœ¼ë¡œ ëë‚˜ë©´ doneì´ í”„ë¦°íŠ¸ë¼ìš”
[...new MyIterable()];

// ìˆœíšŒê°€ ì¤‘ê°„ì— ëŠê¸°ë©´ returnì´ í”„ë¦°íŠ¸ë¼ìš”
let [a, b] = new MyIterable();

// âœï¸ breakë¥¼ ì§€ì›Œë³´ì„¸ìš”
for (let x of new MyIterable()) {
  break;
}
```

## Generators

ì œë„ˆë ˆì´í„° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì´í„°ë ˆì´í„°ì˜ ì¼ì¢…ì¸ **ì œë„ˆë ˆì´í„° ê°ì²´**ê°€ ë°˜í™˜ë©ë‹ˆë‹¤:

```js
function* foo() {
  yield 1;
  yield 2;
  yield 3;
}

console.log(foo().constructor);
console.log(...foo());
```

ì œë„ˆë ˆì´í„°ë¥¼ í™œìš©í•˜ë©´ ì´í„°ë ˆì´í„°ë¥¼ ë§Œë“¤ê¸° ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤:

```js
function* range(from, to) {
  for (let x = from; x <= to; x++) yield x;
}

console.log(...range(0, 5));
```

ì œë„ˆë ˆì´í„°ëŠ” ë°°ì—´ê°™ì€ ìë£Œ êµ¬ì¡°ê°€ ì•„ë‹Œ ì¼ë ¨ì˜ ê³„ì‚° ê³¼ì •ì„ ìˆœíšŒí•´ì•¼í•  ë•Œ íŠ¹íˆ
ìœ ìš©í•©ë‹ˆë‹¤:

```js
function* fibo() {
  let x = 0;
  let y = 1;

  while (true) {
    yield y;
    [x, y] = [y, x + y];
  }
}

function* take(n, iterable) {
  let iterator = iterable[Symbol.iterator]();

  for (let i = 0; i < n; i++) {
    let { value, done } = iterator.next();
    if (done) return;
    yield value;
  }
}

console.log(...take(10, fibo()));
```

`yield*` í‚¤ì›Œë“œë¡œ ë‹¤ë¥¸ ì´í„°ëŸ¬ë¸”ì˜ yield ê²°ê³¼ë¥¼ ëŒ€ì‹  yieldí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```js
function* foo() {
  yield* [1, 2];
}

function* bar() {
  yield* foo();
  yield 3;
}

console.log(...bar());
```

## Advanced Generator Features

ì œë„ˆë ˆì´í„°ëŠ” í•¨ìˆ˜ë¥¼ ì¤‘ê°„ì— ë©ˆì¶”ê³  ì´í›„ ë‹¤ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ ì¼ë°˜
ì´í„°ë ˆì´í„°ë³´ë‹¤ ê°•ë ¥í•©ë‹ˆë‹¤.

ì¼ë°˜ì ì¸ ì´í„°ë ˆì´í„°ì™€ ì œë„ˆë ˆì´í„°ì—ì„œëŠ” `value`ê°€ ìœ ì˜ë¯¸í•œ ê°’ì´ë¼ë©´ `done`ì´
`true`ê°€ ì•„ë‹ˆì§€ë§Œ ì œë„ˆë ˆì´í„°ì˜ `return`ë¬¸ì„ ì‚¬ìš©í•œ ê²½ìš° `true`ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

```js
function* foo() {
  yield 1;
  // âœï¸ return -> yieldë¡œ ìˆ˜ì •í•´ë³´ì„¸ìš”
  return 2;
}

let gen = foo();
console.log(gen.next());
console.log(gen.next());
```

yieldëŠ” ì‚¬ì‹¤ í‘œí˜„ì‹ì´ë©° ì™¸ë¶€ì—ì„œ ê±´ë„¤ì¤€ ê°’ìœ¼ë¡œ í‰ê°€ë©ë‹ˆë‹¤:

```js
function* foo() {
  console.log(yield 1);
  console.log(yield 2);
}

let gen = foo();
console.log(gen.next('a')); // 'a'ëŠ” ë¬´ì‹œë©ë‹ˆë‹¤.
console.log(gen.next('b'));
console.log(gen.next('c'));
```

ì™¸ë¶€ì—ì„œ ì œë„ˆë ˆì´í„° í•¨ìˆ˜ ë‚´ë¶€ì— `return`ê³¼ `throw`ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´í„°ë ˆì´í„°ì™€ ë‹¬ë¦¬ ì œë„ˆë ˆì´í„°ì—ì„œëŠ” `return()` ë©”ì„œë“œë¥¼ ì§ì ‘ ì •ì˜í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ
try/finalllyë¥¼ í™œìš©í•´ cleanupì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function* foo() {
  try {
    yield 1;
    yield 2;
  } catch (e) {
    console.log('handling error...');
  } finally {
    console.log('cleaning...');
    return 'finish';
  }
}

console.log('ğŸ”½ return ì˜ˆì œ');
let it = foo();
console.log(it.next());
console.log(it.return());

console.log('ğŸ”½ throw ì˜ˆì œ');
it = foo();
console.log(it.next());
console.log(it.throw(new Error()));
```
